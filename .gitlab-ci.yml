---

include:
  - project: templates/pipelines
    ref: uikit
    file: /templates/lint/yarn_lint.yaml
  - project: templates/pipelines
    ref: uikit
    file: /templates/lint/sonarqube.yaml
  - project: templates/pipelines
    ref: uikit
    file: /templates/build/yarn_build.yaml
  - project: templates/pipelines
    ref: uikit
    file: /templates/image/storybook_kaniko_image.yaml
  - project: templates/pipelines
    ref: uikit
    file: /templates/deploy/storybook_deploy.yaml
  - project: templates/pipelines
    ref: uikit
    file: /templates/notification/slack_notify.yaml


stages:
- lint
- build-npm
- image
- deploy-storybook
- notification

lint:
  extends: .yarn-lint
  
lint-sonarqube:
  extends: .sonarqube

build-npm:
  extends: .npm-build

image-storybook:
  extends: .kaniko-image
  only:
    - develop
    - develop-ci
    - master

deploy-storybook:
  extends: .storybook-deploy   
  only:
    - develop
    - develop-ci
    - master

Notify fail:
  extends: .notify_fail_slack

Notify success:
  extends: .notify_success_slack
