---
globs: *.tsx,*.ts
alwaysApply: false
---
# SberCloud UI Kit Adaptive Components

## Обзор
Адаптивные компоненты обеспечивают автоматическое переключение между мобильной и десктопной версиями интерфейса в зависимости от размера экрана. Все адаптивные компоненты построены на основе SberCloud UI Kit Product с мобильными пакетами `@sbercloud/uikit-product-mobile-*` и интегрированы с Snack UI Kit для базовых компонентов.

## Интеграция с UI Kit экосистемой

### SberCloud UI Kit Product
- **Основные компоненты**: `@sbercloud/uikit-product-*` - для десктопных версий
- **Мобильные компоненты**: `@sbercloud/uikit-product-mobile-*` - для мобильных версий
- **Predefined компоненты**: `@sbercloud/uikit-product-*-predefined` - готовые решения

### Snack UI Kit
- **Базовые компоненты**: `@snack-uikit/*` - для фундаментальных UI элементов
- **Совместимость**: Все компоненты Snack UI Kit совместимы с адаптивной системой

### Адаптивная система
- **Централизованные адаптивные компоненты**: `#components/AdaptiveComponents`
- **Автоматическое переключение**: между мобильной и десктопной версиями
- **Единый API**: для всех типов устройств

## Основные принципы

### 1. Обязательное использование адаптивных компонентов
**ВСЕГДА используйте адаптивные компоненты** вместо прямого использования мобильных или десктопных версий:

```typescript
// ✅ Правильно - используйте адаптивные компоненты
import { AdaptiveAlert, AdaptiveModal, AdaptiveTable } from '#components/AdaptiveComponents';

// ❌ Неправильно - прямое использование мобильных компонентов
import { MobileAlert } from '@sbercloud/uikit-product-mobile-alert';
import { Alert } from '@sbercloud/uikit-product-alert';
```

### 2. Паттерны создания адаптивных компонентов

#### Паттерн 1: Простое обертывание с `withAdaptive`
Используется когда мобильный компонент уже имеет встроенную адаптивность:

```typescript
import { withAdaptive } from '@sbercloud/cpt-common';
import { AdaptiveAlert as AdaptiveAlertInternal, AlertProps } from '@sbercloud/uikit-product-mobile-alert';

export const AdaptiveAlert: ComponentType<AlertProps> = withAdaptive(AdaptiveAlertInternal);
```

#### Паттерн 2: Условное рендеринг с `useAdaptive`
Используется когда нужно явно выбирать между мобильной и десктопной версиями:

```typescript
import { useAdaptive } from '@sbercloud/cpt-common';
import { MobileFieldSelect } from '@sbercloud/uikit-product-mobile-fields';
import { FieldSelect, FieldSelectProps } from '@snack-uikit/fields-new-select';

export const AdaptiveFieldSelect: ComponentType<FieldSelectProps> = withAdaptive(function ({
  layoutType,
  ...props
}: WithLayoutType<FieldSelectProps>) {
  const isMobile = layoutType === 'mobile';
  return isMobile ? <MobileFieldSelect {...props} /> : <FieldSelect {...props} />;
});
```

#### Паттерн 3: Адаптивные страницы с раздельными параметрами
Используется для сложных страниц с разными параметрами для мобильной и десктопной версий:

```typescript
export type AdaptivePageServicesParams = {
  mobileParams: Omit<MobilePageServicesProps, 'children'>;
  desktopParams: Omit<PageServicesProps, 'children'>;
};

export function AdaptivePageServices({
  children,
  mobileParams,
  desktopParams,
  isLoading
}: AdaptivePageServicesProps) {
  const { isMobile } = useAdaptive();

  if (isMobile) {
    return <MobilePageServices {...mobileParams}>{isLoading ? <PageLoading /> : children}</MobilePageServices>;
  }

  return <PageServices {...desktopParams}>{isLoading ? <PageLoading /> : children}</PageServices>;
}
```

### 3. Доступные адаптивные компоненты

#### Основные компоненты
- `AdaptiveAlert` - Адаптивные уведомления
- `AdaptiveModal` - Адаптивные модальные окна
- `AdaptiveDrawer` - Адаптивные выдвижные панели
- `AdaptiveTable` - Адаптивные таблицы
- `AdaptiveStepper` - Адаптивные пошаговые процессы
- `AdaptiveInfoRow` - Адаптивные информационные строки
- `AdaptiveTooltip` - Адаптивные подсказки
- `AdaptiveQuestionTooltip` - Адаптивные подсказки с вопросами

#### Поля ввода
- `AdaptiveFieldSelect` - Адаптивные селекты

#### Макеты и страницы
- `AdaptiveBlockBasic` - Адаптивные базовые блоки
- `AdaptivePageForm` - Адаптивные формы страниц
- `AdaptivePageServices` - Адаптивные сервисные страницы

#### Специализированные компоненты
- `AdaptiveDeleteModal` - Адаптивные модальные окна удаления

### 4. Хуки для адаптивности

#### `useAdaptive()`
Основной хук для получения информации о текущем типе устройства:

```typescript
const { isMobile, layoutType } = useAdaptive();
```

#### `useAdaptiveStepperApi()`
Хук для работы с адаптивными степперами:

```typescript
const stepperApi = useAdaptiveStepperApi();
```

#### `useAdaptiveGetRowActionsColumnDef()`
Хук для получения конфигурации колонок действий в адаптивных таблицах:

```typescript
const getRowActionsColumnDef = useAdaptiveGetRowActionsColumnDef();
```

### 5. Правила использования

#### Обязательные правила
1. **ВСЕГДА используйте адаптивные компоненты** вместо прямого использования мобильных/десктопных версий
2. **НЕ ПРЕДЛАГАЙТЕ прямые импорты** из `@sbercloud/uikit-product-mobile-*` пакетов
3. **Используйте централизованные адаптивные компоненты** из `#components/AdaptiveComponents`
4. **Проверяйте наличие адаптивной версии** перед созданием кастомных решений

#### Паттерны условного рендеринга
```typescript
// ✅ Правильно - используйте useAdaptive для условной логики
const { isMobile } = useAdaptive();

if (isMobile) {
  return <MobileSpecificComponent />;
}

return <DesktopSpecificComponent />;
```

#### Стилизация адаптивных компонентов
```typescript
// ✅ Правильно - используйте CSS data-атрибуты для адаптивных стилей
const StyledComponent = styled.div`
  ${CSS_DATA_ATTRIBUTES.mobile} {
    padding: 16px;
  }

  padding: 24px;
`;
```

### 6. Интеграция с UI Kit экосистемой

#### Приоритет использования компонентов
1. **Адаптивные компоненты** (высший приоритет)
2. **SberCloud UI Kit Product** (для продуктовых компонентов)
3. **Snack UI Kit** (для базовых компонентов)

#### С Snack UI Kit
```typescript
// ✅ Правильно - комбинируйте адаптивные компоненты с Snack UI Kit
import { Skeleton } from '@snack-uikit/skeleton';
import { AdaptiveAlert } from '#components/AdaptiveComponents';

<AdaptiveAlert
  description={<Skeleton loading width={'100%'} height={24} />}
  appearance='neutral'
/>
```

#### С SberCloud UI Kit Product
```typescript
// ✅ Правильно - используйте predefined компоненты через адаптивные обертки
import { AdaptiveDeleteModal } from '#components/AdaptiveComponents';

// ✅ Правильно - используйте мобильные компоненты через адаптивные обертки
import { AdaptiveModal } from '#components/AdaptiveComponents';
```

#### Комбинирование всех UI Kit
```typescript
// ✅ Правильно - комплексное использование всех UI Kit
import { Skeleton } from '@snack-uikit/skeleton';
import { AdaptiveAlert } from '#components/AdaptiveComponents';
import { PageServices } from '@sbercloud/uikit-product-page-layout';

function MyComponent() {
  return (
    <PageServices>
      <AdaptiveAlert
        description={<Skeleton loading width={'100%'} height={24} />}
        appearance='neutral'
      />
    </PageServices>
  );
}
```

### 7. Лучшие практики

#### Создание новых адаптивных компонентов
1. **Сначала проверьте** наличие готового адаптивного компонента
2. **Используйте паттерн с `withAdaptive`** для простых случаев
3. **Создавайте кастомную логику** только при необходимости
4. **Экспортируйте через централизованный файл** `AdaptiveComponents.tsx`

#### Оптимизация производительности
```typescript
// ✅ Правильно - используйте мемоизацию для тяжелых адаптивных компонентов
const AdaptiveExpensiveComponent = React.memo(withAdaptive(ExpensiveComponentInternal));
```

#### Тестирование адаптивности
```typescript
// ✅ Правильно - тестируйте оба режима
describe('AdaptiveComponent', () => {
  it('renders mobile version on mobile', () => {
    // Тест мобильной версии
  });

  it('renders desktop version on desktop', () => {
    // Тест десктопной версии
  });
});
```

### 8. Антипаттерны

```typescript
// ❌ Неправильно - прямое использование мобильных компонентов
import { MobileAlert } from '@sbercloud/uikit-product-mobile-alert';

// ❌ Неправильно - игнорирование адаптивности
<Alert /> // Без адаптивной обертки

// ❌ Неправильно - дублирование логики адаптивности
const { isMobile } = useAdaptive();
if (isMobile) {
  return <MobileComponent />;
}
return <DesktopComponent />;
// Лучше использовать готовый AdaptiveComponent
```

### 9. Правила для разработчиков

#### Обязательные правила
1. **ВСЕГДА проверяйте наличие адаптивной версии** перед использованием любого UI компонента
2. **НИКОГДА не используйте прямые импорты** из `@sbercloud/uikit-product-mobile-*` пакетов
3. **ВСЕГДА используйте централизованные адаптивные компоненты** из `#components/AdaptiveComponents`
4. **ПРИ СОЗДАНИИ новых компонентов** сразу делайте их адаптивными

#### Алгоритм выбора компонента
```
1. Есть ли адаптивная версия в #components/AdaptiveComponents?
   → ДА: Используйте адаптивную версию
   → НЕТ: Переходите к шагу 2

2. Есть ли мобильная версия в @sbercloud/uikit-product-mobile-*?
   → ДА: Создайте адаптивную обертку
   → НЕТ: Переходите к шагу 3

3. Есть ли десктопная версия в @sbercloud/uikit-product-*?
   → ДА: Используйте десктопную версию (не адаптивную)
   → НЕТ: Переходите к шагу 4

4. Есть ли компонент в @snack-uikit/*?
   → ДА: Используйте Snack UI Kit компонент
   → НЕТ: Создайте кастомный компонент
```

#### Создание новых адаптивных компонентов
```typescript
// 1. Создайте адаптивную обертку
export const AdaptiveMyComponent: ComponentType<MyComponentProps> = withAdaptive(
  AdaptiveMyComponentInternal
);

// 2. Добавьте в AdaptiveComponents.tsx
export { AdaptiveMyComponent } from './AdaptiveMyComponent';

// 3. Экспортируйте через index.ts
export * from './AdaptiveComponents';
```

## Заключение

Адаптивные компоненты обеспечивают единообразный и эффективный подход к созданию интерфейсов, работающих на всех устройствах. Всегда используйте готовые адаптивные компоненты и следуйте установленным паттернам для обеспечения консистентности и производительности.

**Помните**: Адаптивность - это не опция, а обязательное требование для всех UI компонентов в проекте.